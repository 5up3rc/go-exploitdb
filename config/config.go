package config

import (
	"github.com/inconshreveable/log15"
	valid "github.com/asaskevich/govalidator"
)

type CommonConfig struct {
	Debug     bool
        DebugSQL  bool
        Quiet     bool
        DBPath    string
        DBType    string
        HTTPProxy string
}

type SearchConfig struct {
	SearchType string
	SearchParam string
}

type ServerConfig struct {
	Bind string
	Port string	
}

var CommonConf CommonConfig
var SearchConf SearchConfig
var ServerConf ServerConfig

func (p *CommonConfig) Validate() bool {
        if p.DBType == "sqlite3" {
                if ok, _ := valid.IsFilePath(p.DBPath); !ok {
                        log15.Error("SQLite3 DB path must be a *Absolute* file path.", "dbpath", p.DBPath)
                        return false
                }
        }

        _, err := valid.ValidateStruct(p)
        if err != nil {
                log15.Error("Invalid Struct", "err", err)
                return false
        }
        return true
}
