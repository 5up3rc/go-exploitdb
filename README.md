# go-exploitdb
[![MIT License](http://img.shields.io/badge/license-MIT-blue.svg?style=flat)](https://github.com/mozqnet/go-exploitdb/blob/master/LICENSE)

This is a tool for searching Exploits from Exploit-DB by CVE number or Exploit Database ID.
Exploits are inserted at sqlite database(go-exploitdb) from Exploit-DB and can be searched by command line interface.
In server mode, a simple Web API can be used.

# Installation
## Requirements

go-exploitdb requires the following packages.

- SQLite3, MySQL, PostgreSQL, Redis
- git
- lastest version of go
    - https://golang.org/doc/install

## Install go-exploitdb

```bash
$ mkdir -p $GOPATH/src/github.com/mozqnet
$ cd $GOPATH/src/github.com/mozqnet
$ git clone https://github.com/mozqnet/go-exploitdb.git
$ cd go-exploitdb
$ make install
```

----

# Usage

```bash
$ go-exploitdb -h

Usage: go-exploitdb <flags> <subcommand> <subcommand args>

Subcommands:
        commands         list all command names
        flags            describe all known top-level flags
        help             describe subcommands and their syntax

Subcommands for fetchExploit:
        fetchexploit     Fetch Exploit from Exploit-DB

Subcommands for searchExploit:
        searchExploit    search Exploit from go-exploitdb.

Subcommands for server:
        server           Start go-exploitdb HTTP server.


Use "main flags" for a list of top-level flags
```


## Usage: Fetch and Insert Exploit

```bash
$ go-exploitdb fetchExploit -h

fetchExploit:
        fetchExploit
                [-dbtype=sqlite3|mysql|postgres|redis]
                [-dbpath=$PWD/exploitdb.sqlite3 or connection string]
                [-http-proxy=http://192.168.0.1:8080]
                [-debug]
                [-debug-sql]
                [-quiet]
                [-log-dir=/path/to/log]
                [-log-json]
  Command:
        $ go-exploitdb fetchExploit

  -dbpath string
        /path/to/sqlite3 or SQL connection string (default "/go-exploitdb.sqlite3")
  -dbtype string
        Database type to store data in (sqlite3, mysql, postgres or redis supported) (default "sqlite3")
  -debug
        debug mode
  -debug-sql
        SQL debug mode
  -http-proxy string
        http://proxy-url:port (default: empty)
  -log-dir string
        /path/to/log (default "/var/log/go-exploitdb")
  -log-json
        output log as JSON
  -quiet
        quiet mode (no output)
```

### Fetch and Insert Exploit

```bash
$ go-exploitdb fetchexploit
```


## Usage: Search Exploit

```bash
$ go-exploitdb searchexploit -h

searchExploit:
        searchExploit
                [-dbtype=sqlite3|mysql|postgres|redis]
                [-dbpath=$PWD/exploitdb.sqlite3 or connection string]
                [-http-proxy=http://192.168.0.1:8080]
                [-debug]
                [-debug-sql]
                [-quiet]
                [-log-dir=/path/to/log]
                [-log-json]
                [-stype]
                [-sparam]

  Command:
        $ go-exploitdb searchExploit -stype [All/CVE/ID] -sparam [xxxx-xxxx/xxxx]

  ex.
  [*] If you want to search All Exploits
        $ go-exploitdb searchExploit -stype All

  [*] If you want to search Exploit by CVE
        $ go-exploitdb searchExploit -stype CVE -sparam xxxx-xxxx

  [*] If you want to search Exploit by EDB-ID
        $ go-exploitdb searchExploit -stype EDB -sparam xxxx

  -dbpath string
        /path/to/sqlite3 or SQL connection string (default "/go-exploitdb.sqlite3")
  -dbtype string
        Database type to store data in (sqlite3, mysql, postgres or redis supported) (default "sqlite3")
  -debug
        debug mode
  -debug-sql
        SQL debug mode
  -http-proxy string
        http://proxy-url:port (default: empty)
  -log-dir string
        /path/to/log (default "/var/log/go-exploitdb")
  -log-json
        output log as JSON
  -quiet
        quiet mode (no output)
  -sparam string
        All Exploits: None  |  by CVE: [xxxx-xxxx]  |  by Edb-ID: [xxxx]  (default: None)
  -stype string
        All Exploits: All  |  by CVE ID: CVE  |  by Exploit DB ID: EDB  (default: All) (default "All")
```

### Search All Exploits

```bash
$ go-exploitdb searchExploit

or

$ go-exploitdb searchExploit -stype All
```

### Search Exploit by CVE(ex. CVE-2009-4091)

```bash
$ go-exploitdb searchExploit -stype CVE -sparam 2009-4091
```

### Search Exploit by ExploitDB-ID(ex. ExploitDB-ID: 10180)

```bash
$ go-exploitdb searchExploit -stype ID -sparam 10180
```

## Usage: Start go-exploitdb as server mode

```bash
$ go-exploitdb server -h

server:
        server
                [-bind=127.0.0.1]
                [-port=8000]
                [-dbpath=$PWD/exploitdb.sqlite3 or connection string]
                [-dbtype=mysql|sqlite3|redis]
                [-debug]
                [-debug-sql]
                [-quiet]
                [-log-dir=/path/to/log]
                [-log-json]

  Command:
        $ go-exploitdb server

  -bind string
        HTTP server bind to IP address (default: loop back interface) (default "127.0.0.1")
  -dbpath string
        /path/to/sqlite3 or SQL connection string (default "/go-exploitdb.sqlite3")
  -dbtype string
        Database type to store data in (sqlite3, mysql or redissupported) (default "sqlite3")
  -debug
        debug mode (default: false)
  -debug-sql
        SQL debug mode (default: false)
  -log-dir string
        /path/to/log (default "/var/log/go-exploitdb")
  -log-json
        output log as JSON
  -port string
        HTTP server port number (default "1324")
  -quiet
        quiet mode (no output)
```

### Starting Server
```bash
$ go-exploitdb server
INFO[09-30|15:05:57] Starting HTTP Server...
INFO[09-30|15:05:57] Listening...                             URL=127.0.0.1:1324
```

### Get by cURL

### Search Exploit by CVE(ex. CVE-2009-4091)

```
curl http://127.0.0.1:1324/cves/CVE-2008-6938 | jq

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:100   433  100   433    0     0   114k      0 --:--:-- --:--:-- --:--:--  140k
{
  "exploit_db_id": "7109",
  "exploit_db_url": "https://www.exploit-db.com/exploits/7109",
  "cve_id": "CVE-2008-6938",
  "document": {
    "exploit_db_id": "7109",
    "document_url": "https://github.com/offensive-security/exploitdb/exploits/windows/dos/7109.txt",
    "description": "Pi3Web 2.0.3 - 'ISAPI' Remote Denial of Service",
    "date": "2008-11-13T00:00:00Z",
    "author": "Hamid Ebadi",
    "type": "dos",
    "palatform": "windows",
    "port": ""
  },
  "shell_code": null,
  "paper": null
}
```

### Search Exploit by ExploitDB-ID(ex. ExploitDB-ID: 10180)

```
$ curl http://127.0.0.1:1324/edbids/10180 | jq

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  9844    0  9844    0     0   534k      0 --:--:-- --:--:-- --:--:--  565k
[
  {
    "ID": 4,
    "CveID": "2009-4091",
    "ExploitDBID": "10180",
    "Title": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "Url": "https://www.exploit-db.com/exploits/10180/",
    "Path": "/home/shogo/go-exploitdb/exploit-database/exploits/php/webapps/10180.txt",
    "Filetype": "ASCII text, with CRLF line terminators",
    "CodeOrPoc": "################################################################################\r\nMutliple Vulnerabilities in Simplog v0.9.3.2\r\n\r\nName Multiple vulnerabilities in Simplog\r\nSystems Affected Simplog 0.9.3.2 and possibly earlier versions\r\nDownload http://sourceforge.net/projects/simplog/files/simplog/0.9.3.2/simplog-0.9.3.2.tar.gz/download\r\nAuthor Amol Naik (amolnaik4[at]gmail.com)\r\nDate 16/11/2009\r\n################################################################################\r\n\r\n\r\n############\r\n1. OVERVIEW\r\n############\r\n\r\nSimplog provides an easy way for users to add blogging capabilities to their existing websites.\r\nSimplog is written in PHP and compatible with multiple databases.\r\nSimplog also features an RSS/Atom aggregator/reader.\r\n\r\n###############\r\n2. DESCRIPTION\r\n###############\r\n\r\nSimplog is vulnerable to Persistent cross-site scripting, cross-site request forgery and unauthorized comment deletion.\r\n\r\n######################\r\n3. TECHNICAL DETAILS\r\n######################\r\n\r\nSummery:\r\n\r\n(A) Persistent Cross-site Scripting\r\n(B) Cross Site Request Forgery\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n\r\n\r\n(A) Persistent Cross-site Scripting\r\n++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable page comments.php\r\nVulnerable Parameters cname, email\r\n\r\nWhen adding a comment for any blog entry, it is possible to add a Persistent XSS payload in \"Name\" & \"Email\" parameters due to improper sanitization of the user inputs.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nPut this in the comment:\r\n\r\nName: alert(\"AMol_NAik\")\r\nemail:\">alert(\"AMol_NAik\")\r\n\r\n\r\n(B) Cross Site Request Forgery\r\n+++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page user.php\r\n\r\nThis application is vulenrable to CSRF which changes the password of an authenticated user. This is applicable to Admin as well.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nhttp://server/simplog/user.php?pass1=&pass2=&blogid=&act=change\r\n\r\n\r\nFor example, if an authenticated user clicks on the below link, his/her password changes to \"AMol_NAik\".\r\n\r\nhttp://server/simplog/user.php?pass1=AMol_NAik&pass2=AMol_NAik&blogid=1&act=change\r\n\r\n\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n+++++++++++++++++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page comments.php\r\nVulnerable Parameters op, cid\r\n\r\nThe application provides a function to edit n delete the comments to Blog Admin. It is possible for attacker to edit/delete any comment due to improper authorization.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nEdit comment: http://server/simplog/comments.php?op=edit&cid=\r\nDelete Comment: http://server/simplog/comments.php?op=del&cid=\r\n\r\n\r\n############\r\n4. TimeLine\r\n############\r\n\r\n03/11/2009 Bug Discovered\r\n03/11/2009 Reported to Vendor\r\n16/11/2009 No response received till the date\r\n16/11/2009 Public Disclosure"
  },
  {
    "ID": 5,
    "Cve": "2009-4092",
    "EdbId": "10180",
    "Title": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "Url": "https://www.exploit-db.com/exploits/10180/",
    "Path": "/home/shogo/go-exploitdb/exploit-database/exploits/php/webapps/10180.txt",
    "Filetype": "ASCII text, with CRLF line terminators",
    "CodeOrPoc": "################################################################################\r\nMutliple Vulnerabilities in Simplog v0.9.3.2\r\n\r\nName Multiple vulnerabilities in Simplog\r\nSystems Affected Simplog 0.9.3.2 and possibly earlier versions\r\nDownload http://sourceforge.net/projects/simplog/files/simplog/0.9.3.2/simplog-0.9.3.2.tar.gz/download\r\nAuthor Amol Naik (amolnaik4[at]gmail.com)\r\nDate 16/11/2009\r\n################################################################################\r\n\r\n\r\n############\r\n1. OVERVIEW\r\n############\r\n\r\nSimplog provides an easy way for users to add blogging capabilities to their existing websites.\r\nSimplog is written in PHP and compatible with multiple databases.\r\nSimplog also features an RSS/Atom aggregator/reader.\r\n\r\n###############\r\n2. DESCRIPTION\r\n###############\r\n\r\nSimplog is vulnerable to Persistent cross-site scripting, cross-site request forgery and unauthorized comment deletion.\r\n\r\n######################\r\n3. TECHNICAL DETAILS\r\n######################\r\n\r\nSummery:\r\n\r\n(A) Persistent Cross-site Scripting\r\n(B) Cross Site Request Forgery\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n\r\n\r\n(A) Persistent Cross-site Scripting\r\n++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable page comments.php\r\nVulnerable Parameters cname, email\r\n\r\nWhen adding a comment for any blog entry, it is possible to add a Persistent XSS payload in \"Name\" & \"Email\" parameters due to improper sanitization of the user inputs.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nPut this in the comment:\r\n\r\nName: alert(\"AMol_NAik\")\r\nemail:\">alert(\"AMol_NAik\")\r\n\r\n\r\n(B) Cross Site Request Forgery\r\n+++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page user.php\r\n\r\nThis application is vulenrable to CSRF which changes the password of an authenticated user. This is applicable to Admin as well.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nhttp://server/simplog/user.php?pass1=&pass2=&blogid=&act=change\r\n\r\n\r\nFor example, if an authenticated user clicks on the below link, his/her password changes to \"AMol_NAik\".\r\n\r\nhttp://server/simplog/user.php?pass1=AMol_NAik&pass2=AMol_NAik&blogid=1&act=change\r\n\r\n\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n+++++++++++++++++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page comments.php\r\nVulnerable Parameters op, cid\r\n\r\nThe application provides a function to edit n delete the comments to Blog Admin. It is possible for attacker to edit/delete any comment due to improper authorization.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nEdit comment: http://server/simplog/comments.php?op=edit&cid=\r\nDelete Comment: http://server/simplog/comments.php?op=del&cid=\r\n\r\n\r\n############\r\n4. TimeLine\r\n############\r\n\r\n03/11/2009 Bug Discovered\r\n03/11/2009 Reported to Vendor\r\n16/11/2009 No response received till the date\r\n16/11/2009 Public Disclosure"
  },
  {
    "ID": 6,
    "Cve": "2009-4093",
    "EdbId": "10180",
    "Title": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "Url": "https://www.exploit-db.com/exploits/10180/",
    "Path": "/home/shogo/go-exploitdb/exploit-database/exploits/php/webapps/10180.txt",
    "Filetype": "ASCII text, with CRLF line terminators",
    "CodeOrPoc": "################################################################################\r\nMutliple Vulnerabilities in Simplog v0.9.3.2\r\n\r\nName Multiple vulnerabilities in Simplog\r\nSystems Affected Simplog 0.9.3.2 and possibly earlier versions\r\nDownload http://sourceforge.net/projects/simplog/files/simplog/0.9.3.2/simplog-0.9.3.2.tar.gz/download\r\nAuthor Amol Naik (amolnaik4[at]gmail.com)\r\nDate 16/11/2009\r\n################################################################################\r\n\r\n\r\n############\r\n1. OVERVIEW\r\n############\r\n\r\nSimplog provides an easy way for users to add blogging capabilities to their existing websites.\r\nSimplog is written in PHP and compatible with multiple databases.\r\nSimplog also features an RSS/Atom aggregator/reader.\r\n\r\n###############\r\n2. DESCRIPTION\r\n###############\r\n\r\nSimplog is vulnerable to Persistent cross-site scripting, cross-site request forgery and unauthorized comment deletion.\r\n\r\n######################\r\n3. TECHNICAL DETAILS\r\n######################\r\n\r\nSummery:\r\n\r\n(A) Persistent Cross-site Scripting\r\n(B) Cross Site Request Forgery\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n\r\n\r\n(A) Persistent Cross-site Scripting\r\n++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable page comments.php\r\nVulnerable Parameters cname, email\r\n\r\nWhen adding a comment for any blog entry, it is possible to add a Persistent XSS payload in \"Name\" & \"Email\" parameters due to improper sanitization of the user inputs.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nPut this in the comment:\r\n\r\nName: alert(\"AMol_NAik\")\r\nemail:\">alert(\"AMol_NAik\")\r\n\r\n\r\n(B) Cross Site Request Forgery\r\n+++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page user.php\r\n\r\nThis application is vulenrable to CSRF which changes the password of an authenticated user. This is applicable to Admin as well.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nhttp://server/simplog/user.php?pass1=&pass2=&blogid=&act=change\r\n\r\n\r\nFor example, if an authenticated user clicks on the below link, his/her password changes to \"AMol_NAik\".\r\n\r\nhttp://server/simplog/user.php?pass1=AMol_NAik&pass2=AMol_NAik&blogid=1&act=change\r\n\r\n\r\n(C) Edit/Delete Comments (Bypassing Authorization)\r\n+++++++++++++++++++++++++++++++++++++++++++++++++++\r\n\r\nVulnerable Page comments.php\r\nVulnerable Parameters op, cid\r\n\r\nThe application provides a function to edit n delete the comments to Blog Admin. It is possible for attacker to edit/delete any comment due to improper authorization.\r\n\r\n++++\r\nPOC\r\n++++\r\n\r\nEdit comment: http://server/simplog/comments.php?op=edit&cid=\r\nDelete Comment: http://server/simplog/comments.php?op=del&cid=\r\n\r\n\r\n############\r\n4. TimeLine\r\n############\r\n\r\n03/11/2009 Bug Discovered\r\n03/11/2009 Reported to Vendor\r\n16/11/2009 No response received till the date\r\n16/11/2009 Public Disclosure"
  }
]
```

----

# Authors

Shogo Fukuoka ([@mozq912](https://twitter.com/mozq912))

----

# License
MIT

Please see [LICENSE](https://github.com/mozqnet/go-exploitdb/blob/master/LICENSE).
